#!/bin/sh

# Ensure runtime directory ownership and SSH dir/perms; do not create keys here
if id @PKGNAME@ >/dev/null 2>&1; then
  # Ensure directory exists and set ownership + mode without recursive chown
  install -d -m 755 -o @PKGNAME@ -g dialout /var/lib/@PKGNAME@
  user="@PKGNAME@"
  home="$(getent passwd "$user" | cut -d: -f6 2>/dev/null)"
  [ -n "$home" ] || home="/var/lib/$user"
  # ensure ~/.ssh exists and has correct ownership/perms
  install -d -m 700 -o "$user" -g "$user" "$home/.ssh"
  # ssh-keygen sets secure permissions by default; avoid chmod in scriptlets
fi

exit 0
